(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69c0a1e0"],{3307:function(e,t,n){"use strict";n("37c5")},"37c5":function(e,t,n){},"71fc":function(e,t,n){"use strict";n.r(t),n.d(t,"isSpace",(function(){return c}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container calendar-list-container"},[n("div",{staticClass:"filter-container"},[n("div",[n("el-row",{staticClass:"el-row",attrs:{gutter:24}},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"库名"}},[n("el-input",{staticStyle:{width:"300px"},model:{value:e.schemaName,callback:function(t){e.schemaName=t},expression:"schemaName"}})],1),n("el-form-item",{attrs:{label:"表名"}},[n("el-input",{staticStyle:{width:"300px"},model:{value:e.tableName,callback:function(t){e.tableName=t},expression:"tableName"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.queryLineage}},[e._v("查询")]),n("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.resetData}},[e._v("清空")])],1)],1)],1)],1),n("lineageInfo",{ref:"lineageInfo"})],1)])},i=[],o=(n("ac1f"),n("00b4"),n("c9f2"));function c(e){var t=/(^\s+)|(\s+$)|\s+/g;return t.test(e)}var r={components:{lineageInfo:o["a"]},data:function(){return{tableName:"dwd_cart",schemaName:"gmall"}},methods:{queryLineage:function(){this.$refs.lineageInfo.tableName=this.tableName,this.$refs.lineageInfo.schemaName=this.schemaName,this.$refs.lineageInfo.query()},resetData:function(){this.query.tableName=null,this.query.schemaName=null}}},l=r,d=(n("3307"),n("2877")),s=Object(d["a"])(l,a,i,!1,null,"fb18d580",null);t["default"]=s.exports},c9f2:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"1200px",height:"600px"},attrs:{id:"container33"}})},i=[],o=n("b85c"),c=n("7c3e"),r=(n("99af"),n("b775")),l="/lineage",d={getRootNode:function(e,t){var n="".concat(e,".").concat(t);return Object(r["a"])({url:"".concat(l,"/root/").concat(n),method:"get"})},getChildNode:function(e,t){return Object(r["a"])({url:"".concat(l,"/child/").concat(e,"?relation=").concat(t),method:"get"})}},s={data:function(){return{cdata:[],link:[],tableName:"",schemaName:"",lineageData:{isRoot:!0,id:"Root",style:{fill:"red"},children:[{id:"SubTreeNode1",raw:{},children:[{id:"SubTreeNode1.1"},{id:"SubTreeNode1.2",children:[{id:"SubTreeNode1.2.1"},{id:"SubTreeNode1.2.2"},{id:"SubTreeNode1.2.3"}]}]},{id:"SubTreeNode2",children:[{id:"SubTreeNode2.1"}]},{id:"SubTreeNode3",children:[{id:"SubTreeNode3.1"},{id:"SubTreeNode3.2"},{id:"SubTreeNode3.3"}]},{id:"SubTreeNode4"},{id:"SubTreeNode5"},{id:"SubTreeNode6"}]}}},mounted:function(){},methods:{init:function(e,t){console.log("lineageInfo tableName:"+t),console.log("lineageInfo schemaName:"+e),this.schemaName=e,this.tableName=t,this.query()},query:function(){var e=this;d.getRootNode(this.schemaName,this.tableName).then((function(t){e.lineageData=t,e.setChartData()})).catch((function(e){console.log("失败"+e)}))},setChartData:function(){var e=this,t=document.getElementById("container33");t.innerHTML="";var n=t.scrollWidth,a=t.scrollHeight||500,i=new c["a"].TreeGraph({container:"container33",width:n,height:a,modes:{default:["collapse-expand","drag-canvas"]},fitView:!0,layout:{type:"compactBox",direction:"H",defalutPosition:[],getId:function(e){return e.id},getHeight:function(){return 16},getWidth:function(){return 80},getVGap:function(){return 60},getHGap:function(){return 90},getSide:function(e){return"sink"===e.data.relation?"right":"left"}}});i.node((function(e){return{size:16,anchorPoints:[[0,.5],[1,.5]],style:{fill:e.isRoot?"#cea2b0":"#DEE9FF",stroke:e.isRoot?"#8c2b47":"#5B8FF9"},label:e.id+"\n"+e.comment,labelCfg:{position:e.isRoot?"top":"sink"===e.relation?"right":"left"}}})),i.edge((function(){return{type:"cubic-horizontal",color:"#A3B1BF"}})),i.clear(),i.data(this.lineageData),i.render(),i.on("node:click",(function(t){var n=t.item,a=t.item.getModel();if(console.log(n),console.log(a),console.log(a.id+"-"+a.relation),!(a.isRoot||a.children&&a.children.length>0)){var c=a.id,r=a.relation;d.getChildNode(c,r).then((function(t){if("none"!==t){console.log("get data id:"+i.findDataById(c));var n,r=Object(o["a"])(t);try{for(r.s();!(n=r.n()).done;){var l=n.value,d=e.checkNodeId(l,i);l["id"]=d}}catch(s){r.e(s)}finally{r.f()}a.children=t,i.changeData(),console.log(t)}})).catch((function(e){console.log("失败"+e)}))}}))},checkNodeId:function(e,t){console.log("checkName --"+e.id);var n=e["id"];if(t.findDataById(n)){var a=0;while(1)if(a++,n=e["id"]+"("+a+")",!t.findDataById(n))break}return n}}},u=s,f=n("2877"),h=Object(f["a"])(u,a,i,!1,null,null,null);t["a"]=h.exports}}]);